{
  "resolvedId": "/Users/ilaolovannikov/WebstormProjects/ithub-vue/src/entities/Product/model/index.ts",
  "transforms": [
    {
      "name": "vite:load-fallback",
      "result": "import { createEvent, createStore, restore, sample } from 'effector';\nimport { persist } from 'effector-storage/local';\n\nimport { atom } from '@/shared/factories';\nimport { shuffled } from '@/shared/lib';\nimport { appStarted } from '@/shared/services';\n\nimport { getAllProductsQuery } from '../api';\nimport { findCategories } from '../lib/findByParams';\nimport { mapCategoriesLabels } from '../lib/mapCategories';\nimport type { Product } from '../types';\n\nexport const ProductModel = atom(() => {\n    const $categories = restore(\n        getAllProductsQuery.finished.success.map(({ result }) => mapCategoriesLabels(findCategories(result))),\n        []\n    );\n\n    // 4 случайных товара со скидкой\n    const $discountedItems = restore(\n        getAllProductsQuery.finished.success.map(({ result }) =>\n            shuffled(result.filter((el) => Boolean(el.discount_price)).filter((el) => el.is_available)).slice(0, 4)\n        ),\n        []\n    );\n\n    const productLikeSettled = createEvent<{ id: string }>();\n    const $likedProducts = createStore<string[]>([]).on(productLikeSettled, (products, newProduct) => {\n        if (products.find((id) => id === newProduct.id)) {\n            return products.filter((id) => id !== newProduct.id);\n        }\n        return [...products, newProduct.id];\n    });\n\n    const cartProductSettled = createEvent<Product>();\n    const cartProductRemoved = createEvent<Product>();\n    const $productCart = createStore<{\n        [K: string]: {\n            count: number;\n            product: Product;\n        };\n    }>({})\n        .on(cartProductSettled, (products, newProduct) => {\n            if (products[newProduct.id].count) {\n                return {\n                    ...products,\n                    [newProduct.id]: {\n                        product: newProduct,\n                        count: (products[newProduct.id].count += 1),\n                    },\n                };\n            }\n\n            return {\n                ...products,\n                [newProduct.id]: {\n                    product: newProduct,\n                    count: 1,\n                },\n            };\n        })\n        .on(cartProductRemoved, (products, newProduct) => {\n            if (products[newProduct.id]) {\n                return {\n                    ...products,\n                    [newProduct.id]: {\n                        product: newProduct,\n                        count: (products[newProduct.id].count -= 1),\n                    },\n                };\n            }\n\n            return {\n                ...products,\n            };\n        });\n\n    const $productCartCount = $productCart.map((cart) => Object.values(cart).reduce((acc, val) => acc + val.count, 0));\n\n    const $availableProducts = restore(\n        getAllProductsQuery.finished.success.map(({ result }) => result.filter((el) => el.is_available)),\n        []\n    );\n\n    const $newArrivalProducts = $availableProducts.map((products) =>\n        products.sort((a, b) => (new Date(a.createdAt) < new Date(b.createdAt) ? 1 : -1)).slice(0, 8)\n    );\n\n    const $bestSellerProducts = $availableProducts.map((products) =>\n        products.sort((a, b) => (a.count_review > b.count_review ? -1 : 1)).slice(0, 8)\n    );\n\n    const $featuredProducts = $availableProducts.map((products) =>\n        products.sort((a, b) => (a.rating < b.rating ? 1 : -1)).slice(0, 8)\n    );\n\n    persist({\n        pickup: appStarted,\n        store: $likedProducts,\n        key: 'liked-products',\n    });\n\n    persist({\n        pickup: appStarted,\n        store: $productCart,\n        key: 'cart-products',\n    });\n\n    sample({\n        clock: appStarted,\n        target: getAllProductsQuery.start,\n    });\n\n    return {\n        $categories,\n        $discountedItems,\n        productLikeSettled,\n        $likedProducts,\n        $newArrivalProducts,\n        $bestSellerProducts,\n        $featuredProducts,\n        $productCart,\n        cartProductSettled,\n        cartProductRemoved,\n        $productCartCount,\n        $availableProducts,\n    };\n});\n",
      "start": 1750971640304,
      "end": 1750971640320,
      "sourcemaps": null
    },
    {
      "name": "@tailwindcss/vite:generate:build",
      "start": 1750971640320,
      "end": 1750971640320,
      "order": "pre"
    },
    {
      "name": "vite:esbuild",
      "result": "import { createEvent, createStore, restore, sample } from \"effector\";\nimport { persist } from \"effector-storage/local\";\nimport { atom } from \"@/shared/factories\";\nimport { shuffled } from \"@/shared/lib\";\nimport { appStarted } from \"@/shared/services\";\nimport { getAllProductsQuery } from \"../api\";\nimport { findCategories } from \"../lib/findByParams\";\nimport { mapCategoriesLabels } from \"../lib/mapCategories\";\nexport const ProductModel = atom(() => {\n  const $categories = restore(\n    getAllProductsQuery.finished.success.map(({ result }) => mapCategoriesLabels(findCategories(result))),\n    []\n  );\n  const $discountedItems = restore(\n    getAllProductsQuery.finished.success.map(\n      ({ result }) => shuffled(result.filter((el) => Boolean(el.discount_price)).filter((el) => el.is_available)).slice(0, 4)\n    ),\n    []\n  );\n  const productLikeSettled = createEvent();\n  const $likedProducts = createStore([]).on(productLikeSettled, (products, newProduct) => {\n    if (products.find((id) => id === newProduct.id)) {\n      return products.filter((id) => id !== newProduct.id);\n    }\n    return [...products, newProduct.id];\n  });\n  const cartProductSettled = createEvent();\n  const cartProductRemoved = createEvent();\n  const $productCart = createStore({}).on(cartProductSettled, (products, newProduct) => {\n    if (products[newProduct.id].count) {\n      return {\n        ...products,\n        [newProduct.id]: {\n          product: newProduct,\n          count: products[newProduct.id].count += 1\n        }\n      };\n    }\n    return {\n      ...products,\n      [newProduct.id]: {\n        product: newProduct,\n        count: 1\n      }\n    };\n  }).on(cartProductRemoved, (products, newProduct) => {\n    if (products[newProduct.id]) {\n      return {\n        ...products,\n        [newProduct.id]: {\n          product: newProduct,\n          count: products[newProduct.id].count -= 1\n        }\n      };\n    }\n    return {\n      ...products\n    };\n  });\n  const $productCartCount = $productCart.map((cart) => Object.values(cart).reduce((acc, val) => acc + val.count, 0));\n  const $availableProducts = restore(\n    getAllProductsQuery.finished.success.map(({ result }) => result.filter((el) => el.is_available)),\n    []\n  );\n  const $newArrivalProducts = $availableProducts.map(\n    (products) => products.sort((a, b) => new Date(a.createdAt) < new Date(b.createdAt) ? 1 : -1).slice(0, 8)\n  );\n  const $bestSellerProducts = $availableProducts.map(\n    (products) => products.sort((a, b) => a.count_review > b.count_review ? -1 : 1).slice(0, 8)\n  );\n  const $featuredProducts = $availableProducts.map(\n    (products) => products.sort((a, b) => a.rating < b.rating ? 1 : -1).slice(0, 8)\n  );\n  persist({\n    pickup: appStarted,\n    store: $likedProducts,\n    key: \"liked-products\"\n  });\n  persist({\n    pickup: appStarted,\n    store: $productCart,\n    key: \"cart-products\"\n  });\n  sample({\n    clock: appStarted,\n    target: getAllProductsQuery.start\n  });\n  return {\n    $categories,\n    $discountedItems,\n    productLikeSettled,\n    $likedProducts,\n    $newArrivalProducts,\n    $bestSellerProducts,\n    $featuredProducts,\n    $productCart,\n    cartProductSettled,\n    cartProductRemoved,\n    $productCartCount,\n    $availableProducts\n  };\n});\n",
      "start": 1750971640320,
      "end": 1750971640330,
      "order": "normal",
      "sourcemaps": {
        "version": 3,
        "sources": [
          "/Users/ilaolovannikov/WebstormProjects/ithub-vue/src/entities/Product/model/index.ts"
        ],
        "sourcesContent": [
          "import { createEvent, createStore, restore, sample } from 'effector';\nimport { persist } from 'effector-storage/local';\n\nimport { atom } from '@/shared/factories';\nimport { shuffled } from '@/shared/lib';\nimport { appStarted } from '@/shared/services';\n\nimport { getAllProductsQuery } from '../api';\nimport { findCategories } from '../lib/findByParams';\nimport { mapCategoriesLabels } from '../lib/mapCategories';\nimport type { Product } from '../types';\n\nexport const ProductModel = atom(() => {\n    const $categories = restore(\n        getAllProductsQuery.finished.success.map(({ result }) => mapCategoriesLabels(findCategories(result))),\n        []\n    );\n\n    // 4 случайных товара со скидкой\n    const $discountedItems = restore(\n        getAllProductsQuery.finished.success.map(({ result }) =>\n            shuffled(result.filter((el) => Boolean(el.discount_price)).filter((el) => el.is_available)).slice(0, 4)\n        ),\n        []\n    );\n\n    const productLikeSettled = createEvent<{ id: string }>();\n    const $likedProducts = createStore<string[]>([]).on(productLikeSettled, (products, newProduct) => {\n        if (products.find((id) => id === newProduct.id)) {\n            return products.filter((id) => id !== newProduct.id);\n        }\n        return [...products, newProduct.id];\n    });\n\n    const cartProductSettled = createEvent<Product>();\n    const cartProductRemoved = createEvent<Product>();\n    const $productCart = createStore<{\n        [K: string]: {\n            count: number;\n            product: Product;\n        };\n    }>({})\n        .on(cartProductSettled, (products, newProduct) => {\n            if (products[newProduct.id].count) {\n                return {\n                    ...products,\n                    [newProduct.id]: {\n                        product: newProduct,\n                        count: (products[newProduct.id].count += 1),\n                    },\n                };\n            }\n\n            return {\n                ...products,\n                [newProduct.id]: {\n                    product: newProduct,\n                    count: 1,\n                },\n            };\n        })\n        .on(cartProductRemoved, (products, newProduct) => {\n            if (products[newProduct.id]) {\n                return {\n                    ...products,\n                    [newProduct.id]: {\n                        product: newProduct,\n                        count: (products[newProduct.id].count -= 1),\n                    },\n                };\n            }\n\n            return {\n                ...products,\n            };\n        });\n\n    const $productCartCount = $productCart.map((cart) => Object.values(cart).reduce((acc, val) => acc + val.count, 0));\n\n    const $availableProducts = restore(\n        getAllProductsQuery.finished.success.map(({ result }) => result.filter((el) => el.is_available)),\n        []\n    );\n\n    const $newArrivalProducts = $availableProducts.map((products) =>\n        products.sort((a, b) => (new Date(a.createdAt) < new Date(b.createdAt) ? 1 : -1)).slice(0, 8)\n    );\n\n    const $bestSellerProducts = $availableProducts.map((products) =>\n        products.sort((a, b) => (a.count_review > b.count_review ? -1 : 1)).slice(0, 8)\n    );\n\n    const $featuredProducts = $availableProducts.map((products) =>\n        products.sort((a, b) => (a.rating < b.rating ? 1 : -1)).slice(0, 8)\n    );\n\n    persist({\n        pickup: appStarted,\n        store: $likedProducts,\n        key: 'liked-products',\n    });\n\n    persist({\n        pickup: appStarted,\n        store: $productCart,\n        key: 'cart-products',\n    });\n\n    sample({\n        clock: appStarted,\n        target: getAllProductsQuery.start,\n    });\n\n    return {\n        $categories,\n        $discountedItems,\n        productLikeSettled,\n        $likedProducts,\n        $newArrivalProducts,\n        $bestSellerProducts,\n        $featuredProducts,\n        $productCart,\n        cartProductSettled,\n        cartProductRemoved,\n        $productCartCount,\n        $availableProducts,\n    };\n});\n"
        ],
        "mappings": "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",
        "names": []
      }
    },
    {
      "name": "vite:worker",
      "start": 1750971640330,
      "end": 1750971640330,
      "order": "normal-normal"
    },
    {
      "name": "vite:vue",
      "start": 1750971640330,
      "end": 1750971640330,
      "order": "normal"
    },
    {
      "name": "vite:define",
      "start": 1750971640330,
      "end": 1750971640330,
      "order": "normal-normal"
    },
    {
      "name": "vite:build-html",
      "start": 1750971640330,
      "end": 1750971640330,
      "order": "normal-normal"
    },
    {
      "name": "vite:worker-import-meta-url",
      "start": 1750971640330,
      "end": 1750971640330,
      "order": "normal-normal"
    },
    {
      "name": "vite:asset-import-meta-url",
      "start": 1750971640330,
      "end": 1750971640330,
      "order": "normal-normal"
    },
    {
      "name": "vite:dynamic-import-vars",
      "start": 1750971640330,
      "end": 1750971640330,
      "order": "normal-normal"
    },
    {
      "name": "vite:import-glob",
      "start": 1750971640330,
      "end": 1750971640331,
      "order": "normal-normal"
    },
    {
      "name": "unplugin-vue-components",
      "start": 1750971640331,
      "end": 1750971640331,
      "order": "post"
    },
    {
      "name": "vite:build-import-analysis",
      "start": 1750971640331,
      "end": 1750971640331,
      "order": "normal-normal"
    },
    {
      "name": "vite:reporter",
      "start": 1750971640331,
      "end": 1750971640331,
      "order": "normal"
    }
  ]
}
